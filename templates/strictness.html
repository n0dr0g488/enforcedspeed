{% extends "base.html" %}
{% block content %}

    {# Pull in the same inline CSS from mvp_home.html by embedding a small scriptless copy.
       We keep it simple: include the home page stylesheet by rendering it from the home template's style block. #}
    {% include "_mvp_styles.html" %}
    <div class="wrap">
      <div class="card">
        
        <p class="subtle center" style="margin-top: 6px;">
          Rankings based on median ticketed speed over posted speed (only tickets where ticketed &gt; posted).
        </p>

        <div class="subtle" style="margin: 6px 0 10px 0;">
          {% if hide_anon %}
            Viewing: <strong id="viewingMode">Members only</strong> · <a href="{{ url_for('strictness') }}">Show anonymous too</a>
          {% else %}
            Viewing: <strong id="viewingMode">All posts</strong> · {% if current_user.is_authenticated %}
            <a href="{{ url_for('strictness', hide_anon=1) }}">Hide anonymous</a>
          {% else %}
            <a href="#" id="hideAnonLink" onclick="
              var vm=document.getElementById('viewingMode');
              var old=vm.innerText;
              vm.innerText='Members only';
              var msg=document.getElementById('loginRequiredMsg');
              if(msg){msg.style.display='inline';}
              setTimeout(function(){ vm.innerText=old; }, 700);
              return false;
            ">Hide anonymous</a>
            <span id="loginRequiredMsg" class="subtle" style="display:none; margin-left:8px;">You must be logged in to hide anonymous posts.</span>
          {% endif %}
          {% endif %}
        </div>
<div class="blocks">
          <div class="block">
            <strong>Most Strict</strong>
            <ol>
              {% for i in range(20) %}
                {% if i < most_strict|length %}
                  {% set r = most_strict[i] %}
                  <li>
                    <span class="pill">{{ r.state }}</span>
                    <span class="pill">{{ format_road_bucket(r.road) }}</span>
	                    <br>
                    +{{ '%.1f'|format(r.median_overage) }} mph <a href="{{ url_for('bucket_tickets', state=r.state, road=r.road) }}">(tickets: {{ r.tickets }})</a>
                  </li>
                {% else %}
                  <li class="subtle">Waiting for more data…</li>
                {% endif %}
              {% endfor %}
            </ol>
          </div>

          <div class="block">
            <strong>Least Strict</strong>
            <ol>
              {% for i in range(20) %}
                {% if i < least_strict|length %}
                  {% set r = least_strict[i] %}
                  <li>
                    <span class="pill">{{ r.state }}</span>
                    <span class="pill">{{ format_road_bucket(r.road) }}</span>
	                    <br>
                    +{{ '%.1f'|format(r.median_overage) }} mph <a href="{{ url_for('bucket_tickets', state=r.state, road=r.road) }}">(tickets: {{ r.tickets }})</a>
                  </li>
                {% else %}
                  <li class="subtle">Waiting for more data…</li>
                {% endif %}
              {% endfor %}
            </ol>
          </div>
        </div>
      </div>

      <div class="footer">
        © 2025 EnforcedSpeed · Developed by Conor Gordon · Gordon Capital Holdings LLC
      </div>
    </div>
{% endblock %}
